module.exports = class Data1688412138014 {
    name = 'Data1688412138014'

    async up(db) {
        await db.query(`CREATE TABLE "chain_hourly_snapshot" ("id" character varying NOT NULL, "hourly_transaction_count" integer NOT NULL, "hourly_failed_transaction_count" integer NOT NULL, "hourly_gas_consumption" numeric NOT NULL, "block_number" numeric NOT NULL, "timestamp" numeric NOT NULL, "chain_id" text NOT NULL, CONSTRAINT "PK_808ab4ad79ecdb777e0ff479cca" PRIMARY KEY ("id"))`)
        await db.query(`CREATE TABLE "account_balance" ("id" character varying NOT NULL, "amount" numeric NOT NULL, "denom" text NOT NULL, "block_number" integer NOT NULL, "timestamp" numeric NOT NULL, "chain_id" text NOT NULL, "account_id" character varying, "contract_id" character varying, CONSTRAINT "PK_bd893045760f719e24a95a42562" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_029576f147e256f1f93e4865c7" ON "account_balance" ("account_id") `)
        await db.query(`CREATE INDEX "IDX_814ea1ba1acd2dd1063621bb2e" ON "account_balance" ("contract_id") `)
        await db.query(`CREATE TABLE "account_balance_daily_snapshot" ("id" character varying NOT NULL, "amount" numeric NOT NULL, "block_number" numeric NOT NULL, "timestamp" numeric NOT NULL, "chain_id" text NOT NULL, "account_id" character varying, "token_id" character varying, CONSTRAINT "PK_a04225df975c56f6c875186a212" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_6092b228f1792fb6998843ac92" ON "account_balance_daily_snapshot" ("account_id") `)
        await db.query(`CREATE INDEX "IDX_5baed3190c8bd295dd893cc54d" ON "account_balance_daily_snapshot" ("token_id") `)
        await db.query(`CREATE TABLE "account" ("id" character varying NOT NULL, "chain_id" text NOT NULL, CONSTRAINT "PK_54115ee388cdb6d86bb4bf5b2ea" PRIMARY KEY ("id"))`)
        await db.query(`CREATE TABLE "transfer_event" ("id" character varying NOT NULL, "hash" text NOT NULL, "log_index" integer NOT NULL, "amount" numeric NOT NULL, "block_number" numeric NOT NULL, "timestamp" numeric NOT NULL, "chain_id" text NOT NULL, "contract_id" character varying, "from_id" character varying, "to_id" character varying, CONSTRAINT "PK_2a4e1dce9f72514cd28f554ee2d" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_d008073dd25fb1953403ca1589" ON "transfer_event" ("contract_id") `)
        await db.query(`CREATE INDEX "IDX_ecca58970c65f5461f567389cd" ON "transfer_event" ("from_id") `)
        await db.query(`CREATE INDEX "IDX_099de051293e7b528e67be1a99" ON "transfer_event" ("to_id") `)
        await db.query(`CREATE TABLE "contract" ("id" character varying NOT NULL, "name" text, "chain_id" text NOT NULL, CONSTRAINT "PK_17c3a89f58a2997276084e706e8" PRIMARY KEY ("id"))`)
        await db.query(`CREATE TABLE "contract_hourly_snapshot" ("id" character varying NOT NULL, "hourly_transaction_count" integer NOT NULL, "hourly_failed_transaction_count" integer NOT NULL, "hourly_gas_consumption" numeric NOT NULL, "block_number" numeric NOT NULL, "timestamp" numeric NOT NULL, "chain_id" text NOT NULL, "contract_id" character varying, CONSTRAINT "PK_65f32dbfb9d7f490878d3fdf19f" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_19225686039717c737e34d6447" ON "contract_hourly_snapshot" ("contract_id") `)
        await db.query(`ALTER TABLE "account_balance" ADD CONSTRAINT "FK_029576f147e256f1f93e4865c76" FOREIGN KEY ("account_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "account_balance" ADD CONSTRAINT "FK_814ea1ba1acd2dd1063621bb2e4" FOREIGN KEY ("contract_id") REFERENCES "contract"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "account_balance_daily_snapshot" ADD CONSTRAINT "FK_6092b228f1792fb6998843ac928" FOREIGN KEY ("account_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "account_balance_daily_snapshot" ADD CONSTRAINT "FK_5baed3190c8bd295dd893cc54da" FOREIGN KEY ("token_id") REFERENCES "contract"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "transfer_event" ADD CONSTRAINT "FK_d008073dd25fb1953403ca15890" FOREIGN KEY ("contract_id") REFERENCES "contract"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "transfer_event" ADD CONSTRAINT "FK_ecca58970c65f5461f567389cd8" FOREIGN KEY ("from_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "transfer_event" ADD CONSTRAINT "FK_099de051293e7b528e67be1a99f" FOREIGN KEY ("to_id") REFERENCES "account"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "contract_hourly_snapshot" ADD CONSTRAINT "FK_19225686039717c737e34d64476" FOREIGN KEY ("contract_id") REFERENCES "contract"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    }

    async down(db) {
        await db.query(`DROP TABLE "chain_hourly_snapshot"`)
        await db.query(`DROP TABLE "account_balance"`)
        await db.query(`DROP INDEX "public"."IDX_029576f147e256f1f93e4865c7"`)
        await db.query(`DROP INDEX "public"."IDX_814ea1ba1acd2dd1063621bb2e"`)
        await db.query(`DROP TABLE "account_balance_daily_snapshot"`)
        await db.query(`DROP INDEX "public"."IDX_6092b228f1792fb6998843ac92"`)
        await db.query(`DROP INDEX "public"."IDX_5baed3190c8bd295dd893cc54d"`)
        await db.query(`DROP TABLE "account"`)
        await db.query(`DROP TABLE "transfer_event"`)
        await db.query(`DROP INDEX "public"."IDX_d008073dd25fb1953403ca1589"`)
        await db.query(`DROP INDEX "public"."IDX_ecca58970c65f5461f567389cd"`)
        await db.query(`DROP INDEX "public"."IDX_099de051293e7b528e67be1a99"`)
        await db.query(`DROP TABLE "contract"`)
        await db.query(`DROP TABLE "contract_hourly_snapshot"`)
        await db.query(`DROP INDEX "public"."IDX_19225686039717c737e34d6447"`)
        await db.query(`ALTER TABLE "account_balance" DROP CONSTRAINT "FK_029576f147e256f1f93e4865c76"`)
        await db.query(`ALTER TABLE "account_balance" DROP CONSTRAINT "FK_814ea1ba1acd2dd1063621bb2e4"`)
        await db.query(`ALTER TABLE "account_balance_daily_snapshot" DROP CONSTRAINT "FK_6092b228f1792fb6998843ac928"`)
        await db.query(`ALTER TABLE "account_balance_daily_snapshot" DROP CONSTRAINT "FK_5baed3190c8bd295dd893cc54da"`)
        await db.query(`ALTER TABLE "transfer_event" DROP CONSTRAINT "FK_d008073dd25fb1953403ca15890"`)
        await db.query(`ALTER TABLE "transfer_event" DROP CONSTRAINT "FK_ecca58970c65f5461f567389cd8"`)
        await db.query(`ALTER TABLE "transfer_event" DROP CONSTRAINT "FK_099de051293e7b528e67be1a99f"`)
        await db.query(`ALTER TABLE "contract_hourly_snapshot" DROP CONSTRAINT "FK_19225686039717c737e34d64476"`)
    }
}
